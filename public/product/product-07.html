<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>SEMINAR</title>
    <!-- Import Bootstrap, js and font awesome -->
    <link rel="stylesheet" type="text/css" href="../resource/bootstrap-4.4.1-dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="../resource/css/stylesheet.css" />
    <link rel="stylesheet" type="text/css" href="../resource/css/cart.css" />
    <link rel="stylesheet" type="text/css" href="../resource/css/card-news-stysheet.css" />
    <link rel="stylesheet" type="text/css" href="../resource/css/modal.css" />
    <link href="https://fonts.googleapis.com/css2?family=Jura:wght@300;400&display=swap" rel="stylesheet">

</head>

<body data-spy="scroll" data-target=".sticky-sidebar .dropdown-content" data-offset="50">
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="/__/firebase/7.15.5/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="/__/firebase/7.15.5/firebase-analytics.js"></script>

    <!-- Initialize Firebase -->
    <script src="/__/firebase/init.js"></script>

    <script src="/__/firebase/7.15.4/firebase-database.js"></script>
    <script>
        let database = firebase.database()
        function convert(value) {
            value = Number(value);
            return new Intl.NumberFormat('de-DE', { style: 'currency', currency: 'VND' }).format(value);
        }
    </script>
    <!-- Header -->
    <header>
        <!-- Navigation-->
        <nav class="navbar navbar-expand-md"
            style="background-color: rgb(242, 241, 236); padding-top: 0; padding-bottom: 0;">
            <div class="container-fluid">
                <!-- Logo -->
                <a class="navbar-brand" href="../index.html" style="width: 100px;">
                    <img src="../resource/images/logo/Brand1.png" alt="pet-store" width="150%" height="150%">
                </a>
                <!-- Login -->
                <ul class="navbar-nav ml-auto" style="font-size: large;">
                    <li class="nav-item">
                        <div class="dropdown">
                            <button id="header-button" type="button" data-toggle="dropdown" data-target="shopping-cart"
                                class="dropdown-toggle">
                                <i class="fas fa-shopping-cart"> </i> <span id="quantity-cart"
                                    class="badge badge-danger"></span></i>
                            </button>
                            <div class="dropdown-menu dropdown-menu-right">
                                <div class="shopping-cart">
                                    <ul class="shopping-cart-items">

                                    </ul>
                                    <div class="dropdown-divider"></div>
                                    <p class="total-cost"></p>
                                    <a href="../cart-details.html" class="check-out">Thanh Toán</a>
                                </div>
                            </div>
                    </li>
                    <li class="nav-item unsignin">
                        <button id="header-button" type="button" data-toggle="modal" data-target="#Signup">
                            Đăng Ký
                        </button>
                    </li>
                    <li class="nav-item unsignin">
                        <button id="header-button" type="button" data-toggle="modal" data-target="#Signin">
                            Đăng Nhập
                        </button>
                    </li>
                    <li class="nav-item sign-in">
                        <button id="header-button" type="button" class="username">
                            Tên Người Dùng
                        </button>
                    </li>
                    <li class="nav-item sign-in">
                        <button id="header-button" type="button" class="logout">
                            Đăng Xuất
                        </button>
                    </li>
                </ul>
            </div>
            </div>
        </nav>
        <!-- Carousel -->
        <div id="slides" class="carousel slide" data-ride="carousel" style="z-index: 1;">
            <ul class="carousel-indicators">
                <li data-target="#slides" data-slide-to="0" class="active"></li>
                <li data-target="#slides" data-slide-to="1"></li>
                <li data-target="#slides" data-slide-to="2"></li>
                <li data-target="#slides" data-slide-to="3"></li>
            </ul>
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <a class="link-image" href="../pet.html"><img src="../resource/images/Banner/banner1.jpg"
                            alt="pet"></a>
                </div>
                <div class="carousel-item">
                    <a class="link-image" href="../product.html"><img src="../resource/images/Banner/banner2.jpg"
                            alt="Sanpham"></a>
                </div>
                <div class="carousel-item">
                    <a class="link-image" href="../cham-soc.html"><img src="../resource/images/Banner/banner3.jpg"
                            alt="chamsoc"></a>
                </div>
                <div class="carousel-item">
                    <a class="link-image" href="../tin-tuc.html"><img src="../resource/images/Banner/banner4.jpg"
                            alt="tintuc"></a>
                </div>
            </div>
            <!-- Left and right controls -->
            <a class="carousel-control-prev" href="#slides" data-slide="prev">
                <span class="carousel-control-prev-icon"></span>
            </a>
            <a class="carousel-control-next" href="#slides" data-slide="next">
                <span class="carousel-control-next-icon"></span>
            </a>
        </div>

        <!--Menu-->
        <div class="menu" style="background-color: #17a2b8; z-index: 2; width: 100%; padding-left: 10px;">
            <nav class="navbar navbar-expand-sm bg-info navbar-dark position-sticky" style="z-index: 2; padding: 0;">
                <!-- Links -->
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html"> Trang chủ </a>
                    </li>
                    <!-- Dropdown -->
                    <li class="nav-item dropdown">
                        <a class="nav-link" href="../pet.html" id="navbarDropdown"> Hệ thống thú cưng
                        </a>
                        <div class="dropdown-content">
                            <a class="dropdown-item" href="../danh-sach-cho.html"> Chó </a>
                            <a class="dropdown-item" href="../danh-sach-meo.html"> Mèo </a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link" href="../product.html" id="navbarDropdown"> Sản phẩm
                        </a>
                        <div class="dropdown-content">
                            <a class="dropdown-item" href="../product.html#dog-food"> Thức ăn cho
                                chó </a>
                            <a class="dropdown-item" href="../product.html#cat-food"> Thức ăn cho
                                mèo </a>
                            <a class="dropdown-item" href="../product.html#sua-tam"> Sữa tắm </a>
                            <a class="dropdown-item" href="../product.html#other-product"> Phụ kiện
                            </a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link" href="../cham-soc.html" id="navbarDropdown"> Chăm sóc thú cưng
                        </a>
                        <div class="dropdown-content">
                            <a class="dropdown-item" href="chamsoc-000.html"> Hướng dẫn
                                dành cho người mới </a>
                            <a class="dropdown-item" href="chamsoc-001.html"> Tiêm Ngừa
                                Vaccine Cho Thú Cưng Và Những Điều Cần Biết </a>
                            <a class="dropdown-item" href="chamsoc-002.html"> 5 Bệnh
                                Thường Gặp Ở Thú Cưng </a>

                        </div>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../tin-tuc.html"> Tin tức
                            thú cưng </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../lien-he.html"> Liên hệ
                        </a>
                    </li>
                </ul>
                <div class="navbar-nav ml-auto">
                    <!--Searching-->
                    <form class="search-form form-inline my-2 my-md-0">
                        <div>
                            <input id="search-text" class="form-control mr-sm-2" type="search"
                                placeholder="Tìm Kiếm Sản Phẩm" aria-label="Search">
                            <button class="search-btn" type="submit"><i class="fa fa-search"></i></button>
                        </div>
                    </form>
                </div>
            </nav>
        </div>
        <!-- Modal Sign up -->
        <div class="modal fade" id="Signup">
            <div class="modal-dialog">
                <div class="modal-content">
                    <form id="signupform" action="#" method="POST">
                        <div class="container">
                            <h3>Đăng Ký</h3>
                            <p>Vui lòng điền vào mẫu này để tạo một tài khoản.</p>
                            <hr>
                            <div class="row">
                                <div class="col-6">
                                    <label for="fname"><b>Tên</b></label>
                                    <input type="text" placeholder="Enter First Name" name="firstname"
                                        id="sign_up_fname">
                                    <span class="error-form" id="fname_error_message"></span>
                                </div>
                                <div class="col-6">
                                    <label for="lname"><b>Họ</b></label>
                                    <input type="text" placeholder="Enter Last Name" name="lastname" id="sign_up_lname">
                                    <span class="error-form" id="lname_error_message"></span>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-3">
                                    <label for="address"><b>Địa chỉ</b></label>
                                </div>
                                <div class="col-9" style="padding-left: 0px;">
                                    <input type="text" placeholder="Enter Address" name="address" id="sign_up_addr">
                                    <span class="error-form" id="addr_error_message"></span>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-3" style="padding-right: 0px;">
                                    <label for="phone" style="margin-top: 0px;"><b>Số điện thoại</b></label>
                                </div>
                                <div class="col-9" style="padding-left: 0px;">
                                    <input type="number" placeholder="Enter Phone Number" name="phone"
                                        id="sign_up_phone">
                                    <span class="error-form" id="phone_error_message"></span>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-4" style="padding-right: 0px;">
                                    <label for="psw"><b>Mật Khẩu</b></label>
                                </div>
                                <div class="col-8" style="padding-left: 0px;">
                                    <input type="password" placeholder="Enter Password" name="psw" id="sign_up_psw">
                                    <span class="error-form" id="psw_error_message"></span>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-4" style="padding-right: 0px;">
                                    <label for="psw-repeat"><b>Xác Nhận Mật Khẩu</b></label>
                                </div>
                                <div class="col-8" style="padding-left: 0px;">
                                    <input type="password" placeholder="Repeat Password" name="pswrepeat"
                                        id="sign_up_rpsw">
                                    <span class="error-form" id="rpsw_error_message"></span>
                                </div>
                            </div>
                            <hr>
                            <button class="registerbtn">Đăng Ký Tài Khoản</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Modal Sign in -->
        <div class="modal fade" id="Signin">
            <div class="modal-dialog">
                <div class="modal-content">
                    <form action="#" method="POST">
                        <div class="container">
                            <h3>Đăng Nhập</h3>
                            <p>Vui lòng điền vào mẫu này để đăng nhập tài khoản.</p>
                            <hr>
                            <div class="row">
                                <div class="col-3" style="padding-right: 0px;">
                                    <label for="phone"><b>Số điện thoại</b></label>
                                </div>
                                <div class="col-9" style="padding-left: 0px;">
                                    <input id="login-phone" type="text" placeholder="Enter Phone Number" name="phone"
                                        required>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-3" style="padding-right: 0px;">
                                    <label for="psw"><b>Mật Khẩu</b></label>
                                </div>
                                <div class="col-9" style="padding-left: 0px;">
                                    <input id="login-psw" type="password" placeholder="Enter Password" name="psw"
                                        required>
                                </div>
                            </div>
                            <hr>
                            <button id="login-btn" class="loginbtn">Đăng Nhập</button>
                        </div>
                        <div class="container forgotpsw" style="padding-top: 0px;">
                            <a href="../lien-he.html">Quên Mật Khẩu?</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </header>
    <!--End Header -->

    <!-- Content -->
    <div class="container" style="padding: 20px;">
        <div class="container">
            <div class="pull-left">
                <h3 class="inner-title">Chi Tiết Sản phẩm</h3>
            </div>
            <div class="pull-right">
                <div class="beta-breadcrumb font-large">
                    <a href="../../../index.html">Home</a> / <span>Sản Phẩm</span>
                </div>
            </div>
            <div class="clearfix">
            </div>
        </div>
    </div>
    <div class="container">
        <div id="content" class="space-top-none">
            <div class="space60">&nbsp;</div>
            <div class="row">
                <div class="col-9">
                    <div class="row pet-info">
                        <script>
                            let petInfoRef = database.ref('products/-MBxlIreJwlbbyCZ1DBS')
                            petInfoRef.on("value", snapshot => {
                                let data = snapshot.val()
                                let html = ''
                                let price = convert(data.price)
                                html += '<div class="col-sm-4" >'
                                html += '<img src="../' + data.img + '" alt=""'
                                html += 'style="width: 270px; height: 340px;"></div>'
                                html += '<div class="col-sm-8"><div class="single-item-body">'
                                html += '<p class="single-item-title">' + data.name + ' </p><p class="single-item-price">'
                                html += '<span style="font-size: 30px;">Giá: ' + data.price + '</span>'
                                html += '&emsp;<a class="add-to-cart btn btn-outline-warning" data-name="' + data.name + '"'
                                html += 'data-price="' + price + '" data-img="' + data.img + '"> Mua</a></p></div>'
                                html += '<div class="clearfix"></div> <div class="space20">&nbsp;</div> <div class="single-item-desc">'
                                html += '<p>' + data.type + '</p> <p> &nbsp; <div class="clearfix"></div> </p> </div> </div> </div>'
                                $(".pet-info:last").append(html)
                            })
                        </script>
                    </div>
                    <br>
                    <div class="desc">
                        <ul class="nav nav-tabs" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" data-toggle="tab" href="#desc">Mô tả</a>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <div id="desc" class="container tab-pane active"><br>
                                <h4>THÔNG TIN CƠ BẢN</h4>
                                <p>Pate mèo Royal Canin Mother & Babycat giúp hỗ trợ sức khỏe cho các bé mèo mẹ khi mang
                                    thai và mèo con bằng cách cung cấp nguồn dinh dưỡng cần thiết. <br>
                                    Với những bé mèo con, kết cấu mousse của MOTHER & BABYCAT giúp hỗ trợ quá trình
                                    chuyển tiếp sang dạng thức ăn hạt khô. <br>
                                    Công thức của pate phù hợp với nhu cầu dinh dưỡng tối ưu macronutritional theo bản
                                    năng của những bé mèo con. <br>
                                    Ngoài ra, pate còn giúp hỗ trợ sức đề kháng tự nhiên của mèo con. <br>
                                    100% dinh dưỡng hoàn chỉnh và cân bằng.</p>
                                <br>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-3">
                    <div class="widget">
                        <h6 class="widget-title">Sản Phẩm Bán Chạy</h6>
                        <div class="widget-body">
                            <div class="beta-sales beta-lists">
                                <script>
                                    let bestsellerRef = database.ref('products')
                                    bestsellerRef.orderByChild('bestseller').equalTo("1").on("value", snapshot => {
                                        let keys = Object.keys(snapshot.val())
                                        let data = snapshot.val()
                                        keys.forEach(element => {
                                            let html = ''
                                            let price = convert(data[element].price)
                                            html += '<div class="beta-sales beta-lists"> <div class="media beta-sales-item">'
                                            html += '<a href="' + data[element].url + '">'
                                            html += '<img src="../' + data[element].img + '" alt=""></a><div class="media-body">'
                                            html += '<p>' + data[element].name + '</p>'
                                            html += '<span class="beta-sales-price">Giá: ' + price + '</span></div></div></div><br>'
                                            $(".beta-sales:last").append(html)
                                        });
                                    })
                                </script>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="space50">&nbsp;</div>

            <div class="beta-products-list">

                <h4>Sản Phẩm Cùng Loại</h4>
                <div class="row same-product">
                    <script>
                        let sameProductRef = database.ref('products')
                        let type = "Thức ăn cho mèo"
                        sameProductRef.orderByChild('type').equalTo(type).on("value", snapshot => {
                            let keys = Object.keys(snapshot.val())
                            let data = snapshot.val()
                            keys.forEach(element => {
                                let html = ''
                                let price = convert(data[element].price)
                                html += '<div class="col-sm-3">'
                                html += '<div class="card card-product">'
                                html += '<a class="link-image" href="' + data[element].url + '"><img class="card-img-top"'
                                html += 'src="../' + data[element].img + '" alt="pull-1"></a>'
                                html += '<div class="card-body">'
                                html += '<h5 class="card-title">' + data[element].name + '</h5>'
                                html += '<p class="card-text"> Giá: ' + price + '</p>'
html += '<a class="add-to-cart btn btn-primary" data-name="' + data[element].name + '" data-price="' + data[element].price + '"'
                                html += 'data-img="' + data[element].img + '">Mua</a>'
                                html += '   </div>'
                                html += '   </div>'
                                html += '   </div>'
                                $(".same-product:last").append(html)
                            })
                            $(".add-to-cart").click(function () {
                                clickBuy.play()
                                let button = $(this); // Lấy đối tượng mà người dùng click đặt tên là button
                                let name = button.attr("data-name"); // name của sản phẩm là thuộc tính data-name của button
                                let price = button.attr("data-price"); // price của sản phẩm là thuộc tính data-price của button
                                let image = button.attr("data-img"); //image của sản phẩm là thuộc tính data-img của button
                                let quantity = 1; // Số lượng

                                let item = {
                                    name: name,
                                    price: price,
                                    quantity: quantity,
                                    image: image
                                };

                                let exists = false;
                                if (shoppingCartItems.length > 0) {
                                    $.each(shoppingCartItems, function (index, value) {
                                        // Nếu mặt hàng đã tồn tại trong giỏ hàng thì chỉ cần tăng số lượng mặt hàng đó trong giỏ hàng.
                                        if (value.name == item.name) {
                                            value.quantity++;
                                            exists = true;
                                            return false;
                                        }
                                    });
                                }

                                // Nếu mặt hàng chưa tồn tại trong giỏ hàng thì bổ sung vào mảng
                                if (!exists) {
                                    shoppingCartItems.push(item);
                                }

                                // Lưu thông tin vào sessionStorage
                                sessionStorage["shopping-cart-items"] = JSON.stringify(shoppingCartItems); // Chuyển thông tin mảng shoppingCartItems sang JSON trước khi lưu vào sessionStorage
                                // Gọi hàm hiển thị giỏ hàng
                                displayShoppingCartItems();
                            });

                        })
                    </script>
                </div>
            </div>
        </div>
    </div>
    <!-- End Content -->




    <div class="space50">&nbsp;</div>
    <!-- Footer -->
    <footer class="footer-script">
        <script>
            let footerRef = database.ref();
            footerRef.on("value", snapshot => {
                let html = ''
                html += snapshot.child("footer01").val()
                $(".footer-script").html(html)
            })
        </script>
    </footer>
    <!--End Footer -->
</body>

<script type="text/javascript" src="../resource/js/jquery-3.4.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.1/jquery.validate.min.js"></script>
<script type="text/javascript" src="../resource/bootstrap-4.4.1-dist/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src='https://kit.fontawesome.com/a076d05399.js'></script>
<script src="../resource/js/script.js"></script>
<script src="../resource/js/login.js"></script>
<script>
    let shoppingCartItems = [];

    // Kiểm tra nếu đã có sessionStorage["shopping-cart-items"] hay chưa?
    if (sessionStorage["shopping-cart-items"] != null) {
        shoppingCartItems = JSON.parse(sessionStorage["shopping-cart-items"].toString());
        // Hiển thị thông tin từ giỏ hàng
        displayShoppingCartItems();
    }

    let clickBuy = new Audio()
    clickBuy.src = "https://www.soundjay.com/button/beep-07.wav"




    function displayShoppingCartItems() {
        let count = 0
        let sum = 0
        if (sessionStorage["shopping-cart-items"] != null) {
            shoppingCartItems = JSON.parse(sessionStorage["shopping-cart-items"].toString()); // Chuyển thông tin từ JSON trong sessionStorage sang mảng shoppingCartItems.       

            shoppingCartItems.forEach(element => {
                count += element.quantity;
            });

            $("#quantity-cart").html(count);
            $(".shopping-cart > .shopping-cart-items").html("");
            // Duyệt qua mảng shoppingCartItems để append từng item
            $.each(shoppingCartItems, function (index, item) {
                let price = item.price
                let htmlString = "";
                htmlString += "<li>";
                htmlString += "<img src='../" + item.image + "' alt='' />";
                htmlString += "<span class='item-name'>" + item.name + "</span>";
                htmlString += "<span class='item-price'>" + price + "</span>";
                htmlString += "<span class='item-quantity'>Số lượng: " + item.quantity + "</span>";
                htmlString += "</li>";
                htmlString += "<div class='dropdown-divider'></div>";
                $(".shopping-cart > .shopping-cart-items:last").append(htmlString);
                sum += item.price * item.quantity;
            });
            let cost = convert(sum);
            $(".total-cost").html("Tổng Tiền: " + cost)
        }
    }
</script>

</html>